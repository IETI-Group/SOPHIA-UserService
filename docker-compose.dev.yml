version: '3.8'

services:
  app-dev:
    build:
      context: .
      dockerfile: Dockerfile.dev
      target: development
    ports:
      - ${APP_PORT:-3000}:3000
    environment:
      - NODE_ENV=development
      - DB_HOST=${DB_HOST:-localhost}
      - DB_PORT=${DB_PORT:-5433}
      - DB_NAME=${DB_NAME:-dev_db}
      - DB_USER=${DB_USER:-dev_user}
      - DB_PASSWORD=${DB_PASSWORD:-dev_password}
    volumes:
      - .:/app
      - /app/node_modules
    command: pnpm run dev
    restart: unless-stopped
    # Para conectar con la base de datos, usa docker-compose.db.yml por separado
    # o descomenta network_mode si ambos corren juntos
    # network_mode: "host"
  